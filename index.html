<!DOCTYPE html>
<html>
<head>
    <title>OVER DROP</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1e0033, #3a0068);
            color: white;
            padding: 20px;
        }
        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .btn {
            background: #7000ff;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="card">
        <h2>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
        <p id="balance">–ë–∞–ª–∞–Ω—Å: –∑–∞–≥—Ä—É–∑–∫–∞...</p>
        <p id="referral">–†–µ—Ñ–µ—Ä–∞–ª–æ–≤: 0</p>
        <button class="btn" onclick="getDailyBonus()">üéÅ –ü–æ–ª—É—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å</button>
    </div>

    <div class="card">
        <h2>üéÅ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∫–µ–π—Å—ã</h2>
        <p>–û—Å—Ç–∞–ª–æ—Å—å —Å–µ–≥–æ–¥–Ω—è: <span id="cases-left">3</span>/3</p>
        <button class="btn" onclick="openCase()">–û—Ç–∫—Ä—ã—Ç—å (–ë–µ—Å–ø–ª–∞—Ç–Ω–æ)</button>
    </div>

    <div class="card">
        <h2>üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h2>
        <p>–í–∞—à–∞ —Å—Å—ã–ª–∫–∞:</p>
        <input type="text" id="ref-link" readonly style="width:100%; padding:8px; border-radius:5px; border:none;">
        <button class="btn" onclick="copyRefLink()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setText("–û–±–Ω–æ–≤–∏—Ç—å").show().onClick(function() { location.reload() });

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserData() {
            const user = tg.initDataUnsafe.user;
            document.getElementById('balance').textContent = `–ë–∞–ª–∞–Ω—Å: –∑–∞–≥—Ä—É–∑–∫–∞...`;
            
            // –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É –±—ç–∫–µ–Ω–¥—É
            // –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º localStorage
            const balance = localStorage.getItem('balance') || 100;
            document.getElementById('balance').textContent = `–ë–∞–ª–∞–Ω—Å: ${balance} –º–æ–Ω–µ—Ç`;
        }

        // –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å
        function getDailyBonus() {
            tg.showPopup({
                title: "–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å",
                message: "–í—ã –ø–æ–ª—É—á–∏–ª–∏ 50 –º–æ–Ω–µ—Ç!",
                buttons: [{ type: "ok" }]
            });
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç
            tg.sendData(JSON.stringify({ action: "get_bonus" }));
            loadUserData();
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞
        function openCase() {
            const casesLeft = parseInt(document.getElementById('cases-left').textContent);
            if (casesLeft <= 0) {
                tg.showAlert("–õ–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω!");
                return;
            }
            
            tg.sendData(JSON.stringify({ action: "open_case" }));
            document.getElementById('cases-left').textContent = `${casesLeft - 1}/3`;
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
        function copyRefLink() {
            const refLink = `https://t.me/${tg.initDataUnsafe.user.username}?start=ref_${tg.initDataUnsafe.user.id}`;
            navigator.clipboard.writeText(refLink);
            tg.showAlert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!");
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        tg.ready();
        loadUserData();
    </script>
</body>
</html>